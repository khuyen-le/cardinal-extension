"0","df.trial <- df.raw_exp2 %>% "
"0","  select(id, age_months, age_years, age_years_cont, age_zscored,"
"0","         stim_set, highest_count,"
"0","         trial, trial_type, ratio, magnitude, "
"0","         set_chosen, count, correction_after_prompt, final_count,"
"0","         precounted, n_item1, n_item2, loc_item1) %>%"
"0","  mutate(count = as.numeric(count)) %>%"
"0","  rowwise() %>%"
"0","  mutate(trial_ratio = paste(sort(c(n_item1, n_item2)), collapse = ""-"")) %>%"
"0","  mutate(precounted = ifelse(precounted == """", NA, precounted), "
"0","         "
"0","    target_count = case_when( #target count is always the larger number"
"0","           n_item1 > n_item2 ~ n_item1, "
"0","           n_item2 > n_item1 ~ n_item2, "
"0","         ), "
"0","         target_set = case_when("
"0","           target_count == n_item1 ~ loc_item1, "
"0","           target_count == n_item2 & loc_item1 == ""bottom"" ~ ""top"", "
"0","           target_count == n_item2 & loc_item1 == ""top"" ~ ""bottom"""
"0","         ),"
"0","         correct_set_chosen =  case_when("
"0","           target_set == set_chosen ~ 1,"
"0","           target_set != set_chosen ~ 0, "
"0","           is.na(set_chosen) ~ 0,"
"0","         ),"
"0","         correct_count = case_when("
"0","           is.na(final_count) ~ 0,"
"0","           final_count == target_count ~ 1, "
"0","           final_count != target_count ~ 0"
"0","         ), "
"0","         correct_set_chosen_or_correct_count = ifelse("
"0","           correct_count == 1 | correct_set_chosen == 1, 1, 0"
"0","         ),"
"0","         correct_count_when_correct_set_chosen = ifelse("
"0","           correct_count == 1 & correct_set_chosen == 1, 1, 0"
"0","         ),"
"0","         count_error = case_when("
"0","           !is.na(final_count) ~ final_count - target_count"
"0","         ), "
"0","         correct_count_approx = case_when("
"0","           is.na(final_count) ~ 0, "
"0","           count_error >= -1 & count_error <= 1 ~ 1, "
"0","           count_error < -1 | count_error > 1 ~ 0"
"0","         )) "
"0",""
"0","write.csv(df.trial, ""../../../data/exp2/PROCESSED_DATA/exp2_trial.csv"", row.names = FALSE)"
